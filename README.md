
# Survey Maker

یک وب اپلیکیشن برای ساخت و مدیریت نظرسنجی‌ها با جنگو و drf.
در حالت تکمیل‌شده، کاربران می‌توانند نظرسنجی‌ ایجاد کرده و انواع مختلف سؤالات (تشریحی، چند گزینه‌ای، ماتریسی و عددی) را اضافه کنند. سپس پاسخ‌دهندگان می‌توانند به این نظرسنجی‌ها پاسخ دهند.

## ساختار اپ‌ها

- `surveys`: مدیریت ایجاد نظرسنجی‌ها و ویژگی‌های مربوطه.
- `questions`: مدیریت انواع مختلف سؤالات (تشریحی، چند گزینه‌ای، ماتریسی و عددی).
- `answers`: مدیریت پاسخ‌های کاربران به نظرسنجی‌ها.
- `users`:مدیریت احراز هویت کاربران
- `people`:مدیریت سایر اطلاعات کاربران

  
  
  توضیح: بنا به تجربه شخصی در استفاده از اپ‌های نظرسنجی‌ساز، ماهیت "کاربر" متعلق به کسیست که نظرسنجی را می‌سازد. و پاسخ‌دهندگان، در قالب سوال اول پرسشنامه نام و نام خوانوادگی خود را وارد می‌کنند. لذا در این پروژه هم، منظور از "کاربر"، صاحب نظرسنجی است.
  بنا بر best practice، یک مدل CustomUser داریم که از user model خود جنگو ارث‌بری می‌کند. به همراه یک مدل Person که جهت اضافه کردن فیلدهای دیگر به ماهیت کاربر (مانند شماره تلفن، جنسیت، سن و...) استفاده شده است.



مهم: ابتدا تصمیم بر این بود که یک مدل Question و یک مدل Answer داشته باشیم تا تمام اطلاعات مربوط به سوالات و جواب‌ها در آن‌ها دخیره شود. به عنوان مثال، برای مدل Answer چنین ساختاری مدنظر بود:
```python
  class Answer(models.Model):
      response = models.ForeignKey(Response, related_name='answers', on_delete=models.CASCADE)
      question = models.ForeignKey(Question, on_delete=models.CASCADE)
      # Fields to capture different types of answers:
      answer_text = models.TextField(blank=True, null=True)  # For descriptive answers
      answer_bool = models.BooleanField(blank=True, null=True)  # For Yes/No answers
      selected_choice = models.ForeignKey(Choice, blank=True, null=True, on_delete=models.SET_NULL)  # For multiple choice
```
در صورتی که چنین ساختاری normalized نیست و به عنوان مثال، اگر یک میلیون رکورد سوال چندگزینه‌ای داشته باشیم، در تمامی این رکوردها، فیلدهای مربوط به پاسخ تشریحی خالی می‌مانند.

لذا تصمیم بر این شد که از دو ویژگی برنامه‌نویسی شی‌گرا (inheritance & polymorphism) استفاده شود. بدین صورت که دو مدل Abstract برای سوالات و جواب‌ها داشته باشیم که انواع سوالات و جواب‌خای متناظرشان، از این مدل‌ها ارث‌بری کنند.

## مدل‌های اصلی

### Survey

مدل `Survey` برای نمایش یک نظرسنجی استفاده می‌شود که شامل عنوان، توضیحات و کاربر است.


### Question

مدل پایه `Question` شامل فیلدهای مشترک بین انواع مختلف سؤالات است. انواع مختلف سؤالات شامل موارد زیر می‌شود:
- `DescriptiveQuestion`: سوالات تشریحی که کاربران پاسخ متنی وارد می‌کنند.
- `MultipleChoiceQuestion`: سوالات چند گزینه‌ای که کاربران از بین گزینه‌ها انتخاب می‌کنند.
- `NumericQuestion`: سوالاتی که کاربران با یک عدد به آن پاسخ می‌دهند.
- `MatrixQuestion`: سوالات ماتریسی که به شکل یک جدول از ردیف‌ها و ستون‌ها نمایش داده می‌شوند.

### Answer

مدل پایه `Answer` برای ذخیره پاسخ‌های کاربران به هر سؤال استفاده می‌شود. برای هر نوع سؤال، مدل پاسخ مربوطه نیز وجود دارد:
- `DescriptiveAnswer`
- `MultipleChoiceAnswer`
- `RangeAnswer`
- `MatrixAnswer`



### Response

مدل `Response` برای ذخیره کردن metadata مربوط به پاسخ‌هاست. هر instance از این مدل، به چندین instance از مدل Answer ارتباط دارد که این کار، به آسان‌تر شدن کوئری زدن و همچنین جلوگیری از تکرار دیتا در هر جواب کمک می‌کند.
  ## هندل کردن سوالات ماتریسی:
شمای مدل‌های مربوط به سوالات ماتریسی بدین صورت است: 
![sanjup_1](https://github.com/user-attachments/assets/707721c9-d9bc-47aa-bc8b-bc92202611d0)

## تغییرات
تغییراتی در dependency مدل‌ها ایجاد شد تا normalizedتر و بی‌اشکال شوند. بدین صورت که هر نوع جواب، مستقیما با مدل سوال متناظر خود relation دارد. (به عنوان مثال `DescriptiveAnswer` با `DescriptiveQuestion` ارتباط دارد؛ نه با `Question`.
مشکل تکراری بودن `related_name` های کلس‌های child هم با استفاده از سینتکس خاص جنگو برای این مواقع مرتفع شد. (قابل مشاهده در مدل‌های `Question` و `Answer`)
# Main APIs
داکیومنتیشن خودکار swagger به پروژه اضافه شد که از طریق localhost:8000/swagger قابل‌دسترسیست.
- `SurveyCreateAPIView`
  ساخت پرسش‌نامه
- `SurveyListAPIView`
  نمایش پرسش‌نامه‌های کاربر لاگین‌شده به طور خلاصه و کلی (برای اندپوینتی که جزئیات بیشتری را از پرسش‌نامه نمایش می‌دهد، می‌توان با استفاده از سریالایزرهای تودرتو (nested) سوالات پرسش‌نامه را نیز نمایش داد.)
- `[questiontype]QuestionAPIView`
  ساخت سوالات با انواع مختلف
- `[answerntype]AnswerAPIView`
  پاسخ دادن به انواع سوالات
- `ResponseListAPIView`
  لیست تمام پاسخ‌های ثبت‌شده برای یک پرسشنامه
  
  نکته: اندپوینت‌ها در حالت ساده طراحی شده‌اند. می‌توان validationهای بیشتر و ضروری‌ای اضافه کرد. به عنوان مثال در اندپوینت‌های مربوط به پاسخ دادن، می‌توان id سوال را در url قرار داد و سوال و پرسش‌نامه‌ی مربوط به آن پاسخ را بدین گونه ثبت نمود. یا یونیک بودن پاسخ‌ها در هر سطر مانریس را validate کرد.
  ## Unit Tests
  برای 2 تا از اندپوینت‌ها، unit test نوشته شده: `ResponseListAPIView` و `SurveyCreateAPIView`.
  سپاس از این که مطالعه کردید.
